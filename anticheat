Clear-Host
Write-Host @"
.----------.
| SALVENIA |
'----------'
"@ -ForegroundColor Cyan

Write-Host "Pulse/Ars`n"

do {
    Write-Host "Lütfen yapmak istediğiniz işlemi seçin:" -ForegroundColor Green
    Write-Host "1. Disk Kontrolü"
    Write-Host "2. Icon Kontrolü"
    Write-Host "3. Son Çalıştırılanla"
    Write-Host "4. Crash Dumps"
    Write-Host "5. Rar Kontrolü"
    Write-Host "6. DirectX Kontrolü"
    Write-Host "7. BrowserHistory Kontrolü"
    Write-Host "8. USB Kontrolü"
    Write-Host "9. Son Kullanılan Uygulamalar"
    Write-Host "10. Çalıştırılan Exeler Loglama"
    Write-Host "11. Eski Dosyaları Loglama"
    Write-Host "12. Issus.exe Loglarını İncele"
    Write-Host "13. Explorer.exe Loglarını İncele"
    Write-Host "14. Çıkış"

    $choice = Read-Host "Seçiminizi yapın"

    switch ($choice) {
        "1" {
            Start-Process "diskmgmt.msc"
            Write-Host "Disk Yönetimi açılıyor..." -ForegroundColor Yellow
        }
        "2" {
            Start-Process "explorer.exe" "shell:::{05d7b0f4-2121-4eff-bf6b-ed3f69b894d9}"
            Write-Host "Icon Kontrolü açılıyor..." -ForegroundColor Yellow
        }
        "3" {
            Start-Process "explorer.exe" "shell:recent"
            Write-Host "Son Çalıştırılanlar açılıyor..." -ForegroundColor Yellow
        }
        "4" {
            Start-Process "explorer.exe" "$env:LOCALAPPDATA\CrashDumps"
            Write-Host "Crash Dumps klasörü açılıyor..." -ForegroundColor Yellow
        }
        "5" {
            reg export "HKEY_CURRENT_USER\SOFTWARE\WinRAR\ArcHistory" "$env:USERPROFILE\Desktop\RarKontrol.reg" /y
            Write-Host "WinRAR kayıtları yedeklendi." -ForegroundColor Yellow
        }
        "6" {
            reg export "HKEY_CURRENT_USER\SOFTWARE\Microsoft\DirectInput" "$env:USERPROFILE\Desktop\DirectXKontrol.reg" /y
            reg export "HKEY_CURRENT_USER\SOFTWARE\Microsoft\DirectInput\MostRecentApplication" "$env:USERPROFILE\Desktop\MostRecentApp.reg" /y
            Write-Host "DirectX kayıtları yedeklendi." -ForegroundColor Yellow
        }
        "7" {
            reg export "HKEY_LOCAL_MACHINE\SOFTWARE\Clients\StartMenuInternet" "$env:USERPROFILE\Desktop\BrowserKontrol.reg" /y
            Write-Host "DirectX kayıtları yedeklendi." -ForegroundColor Yellow
        }
        "8" {
            reg export "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR" "$env:USERPROFILE\Desktop\USBKontrol.reg" /y
            Write-Host "USB cihaz geçmişi yedeklendi." -ForegroundColor Yellow
        }
        "9" {
            $AppSwitchedPath = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\FeatureUsage\AppSwitched"
            Get-ItemProperty -Path $AppSwitchedPath |
            Select-Object * |
            Out-GridView -PassThru -Title 'XDDDDDDD'
        }
        "10" {
            $backupPath = "$env:USERPROFILE\Desktop\backup.txt"
            Get-CimInstance Win32_Process | ForEach-Object {
                "$($_.Name) - $($_.CreationDate)" | Out-File -Append $backupPath
            }
            Write-Host "Çalıştırılan Exeler yedekleniyor. Dosya: $backupPath" -ForegroundColor Yellow
        }
        "11" {
            $cleanerPath = "$env:USERPROFILE\Desktop\backupcleaner.txt"
            Get-ChildItem -Path $env:USERPROFILE -Recurse -File -ErrorAction SilentlyContinue |
            Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-1) } |
            ForEach-Object { "$($_.FullName) - $($_.LastWriteTime)" | Out-File -Append $cleanerPath }
            Write-Host "Eski dosyalar loglandı. Dosya: $cleanerPath" -ForegroundColor Yellow
        }
        "12" {
            $issusLogPath = "$env:USERPROFILE\AppData\Local\Temp\issus.log"
            if (Test-Path $issusLogPath) {
                Get-Content $issusLogPath | Out-GridView -Title "Issus.exe Logları"
                Write-Host "Issus.exe logları gösterildi." -ForegroundColor Yellow
            } else {
                Write-Host "Issus.exe log dosyası bulunamadı." -ForegroundColor Red
            }
        }
        "13" {
            $explorerLogPath = "$env:USERPROFILE\AppData\Local\Microsoft\Windows\Explorer"
            if (Test-Path $explorerLogPath) {
                Get-ChildItem $explorerLogPath | Out-GridView -Title "Explorer.exe Logları"
                Write-Host "Explorer.exe logları gösterildi." -ForegroundColor Yellow
            } else {
                Write-Host "Explorer.exe log klasörü bulunamadı." -ForegroundColor Red
            }
        }
        "14" {
            Write-Host "Çıkış yapılıyor..." -ForegroundColor Red
        }
        Default {
            Write-Host "Geçersiz seçim, lütfen 1-13 arasında bir değer girin." -ForegroundColor Red
        }
    }
    Write-Host ""
} while ($choice -ne "14")
